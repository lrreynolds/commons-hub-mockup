<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Commonshub — Start</title>
</head>
<body>
<script>
(() => {
  const params = new URLSearchParams(window.location.search);
  const reset = params.get("reset") === "1";

  try {
    if (reset) {
      // Full reset of the flow
      localStorage.removeItem("commonshub_server_live");
      localStorage.removeItem("commonshub_setup_complete");
      localStorage.removeItem("commonshub_setup_step");
      localStorage.removeItem("commonshub_celebrate_once");
    }
  } catch {}

  let serverLive = false;
  let setupDone = false;

  try {
    serverLive = localStorage.getItem("commonshub_server_live") === "1";
    setupDone  = localStorage.getItem("commonshub_setup_complete") === "1";
  } catch {}

  // 1) Not provisioned yet → start server setup at Step 1
  if (!serverLive) {
    window.location.replace("setup-basics.html"); // Step 1: Pick plan
    return;
  }

  // 2) Server live but community not set up → dashboard (pre-setup state)
  if (!setupDone) {
    window.location.replace("dashboard.html");
    return;
  }

  // 3) Fully set up → dashboard (post-setup zen)
  window.location.replace("dashboard.html");
})();
</script>
</body>
</html>
